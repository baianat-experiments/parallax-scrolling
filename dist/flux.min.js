var t,e;t=this,e=function(){"use strict";var i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),c=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};var e=function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];i(this,n),this.elementsData=t,this.settings=Object.assign({},n.defaults,e),this._init()}return t(n,[{key:"addElement",value:function(t){var e=this;this.elementsData.push(t),this._initElements(),setTimeout(function(){return e.update()},500)}},{key:"_init",value:function(){this.scrolled=window.scrollY,this.viewport={height:window.innerHeight,width:window.innerWidth},this._initObserver(),this._initElements(),this._initEvents(),this.update(!0)}},{key:"_initElements",value:function(){var i=this;this.mediaQuery=window.matchMedia("(min-width: "+this.settings.breakpoint+"px)"),this.elements=[],this.elementsData.forEach(function(t){var e,n="string"==typeof(e=t.element)?document.querySelector(e):e;n.style.willChange="transform",t.element=n,t.rect=n.getBoundingClientRect(),i.addMissingData(t),i.generateFixedData(t),i.observer.observe(n),i.elements.push(t.element)})}},{key:"_initObserver",value:function(){this.observer=new IntersectionObserver(function(t){t.forEach(function(t){t.isIntersecting?t.target.dataset.fluxInViewport="true":t.target.dataset.fluxInViewport=""})})}},{key:"_initEvents",value:function(){var t=this;this.ticking=!1,window.addEventListener("scroll",function(){t.scrolled=window.scrollY,t.ticking||(window.requestAnimationFrame(function(){t.update(),t.ticking=!1}),t.ticking=!0)},{passive:!0}),window.addEventListener("resize",function(t){var e=arguments,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:16,i=!1;return function(){i||(t.apply(void 0,e),i=!0,setTimeout(function(){i=!1},n))}}(function(){t.viewport={height:window.innerHeight,width:window.innerWidth},t.scrolled=window.scrollY,t.reload()},100))}},{key:"reload",value:function(){var e=this;this.elementsData.forEach(function(t){t.rect=t.element.getBoundingClientRect(),e.generateFixedData(t)}),this.update(!0)}},{key:"update",value:function(){var a=this,r=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.elements.forEach(function(t,e){var n=a.elementsData[e];if(t.dataset.fluxInViewport||!n.class||"toggle"!==Object.values(n.class)[0]){if(t.dataset.fluxInViewport||r){if(!a.mediaQuery.matches)return n.element.style.transform="",void(n.element.style.opacity="");if(n.class){var i="string"==typeof n.class?n.class:Object.keys(n.class)[0];t.classList.add(i)}a.updateTransformation(t,n)}}else t.classList.remove(Object.keys(n.class)[0])})}},{key:"updateTransformation",value:function(t,e){var n=e.unitPerScroll,i=e.translate.unit,l=this.scrolled-e.position;function a(t,e){return n=t[0]+l*e,i=c(t,2),a=i[0],r=i[1],s=r<a?a:r,o=a<r?a:r,Math.max(Math.min(n,s),o);var n,i,a,r,s,o}t.style.transform="\n      "+(n.x?"translateX("+a(e.translate.x,n.x)+i+")":"")+"\n      "+(n.y?"translateY("+a(e.translate.y,n.y)+i+")":"")+"\n      "+(n.deg?"rotate("+a(e.rotate,n.deg)+"deg)":"")+"\n      "+(n.scale?"scale("+a(e.scale,n.scale)+")":"")+"\n    ",t.style.opacity=n.opacity?a(e.opacity,n.opacity):""}},{key:"addMissingData",value:function(t){t.translate||(t.translate={}),t.translate.unit||(t.translate.unit="px")}},{key:"generateFixedData",value:function(e){var t=0,n=0;e.translate&&e.translate.y&&(t=a(e.translate.y[0]),n=a(e.translate.y[1]-e.translate.y[0]));var i=(e.finishRatio||this.settings.finishRatio)*this.viewport.height+(this.settings.outOfViewport?e.rect.height:0)+n;function a(t){return"px"===e.translate.unit?t:t/100*e.rect.height}function r(t){var e=c(t,2),n=e[0];return(e[1]-n)/i}e.position=this.scrolled+e.rect.top+t-this.viewport.height,e.unitPerScroll=Object.assign({},e.translate.y&&{y:r(e.translate.y)},e.translate.x&&{x:r(e.translate.x)},e.rotate&&{deg:r(e.rotate)},e.scale&&{scale:r(e.scale)},e.opacity&&{opacity:r(e.opacity)})}}]),n}();return e.defaults={breakpoint:0,finishRatio:1,outOfViewport:!0},e},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Flux=e();