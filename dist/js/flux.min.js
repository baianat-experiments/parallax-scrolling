!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Flux=e()}(this,function(){"use strict";function t(t){return"string"==typeof t?document.querySelector(t):t}function e(t,e){var n=arguments;void 0===e&&(e=16);var a=!1;return function(){a||(t.apply(void 0,n),a=!0,setTimeout(function(){a=!1},e))}}function n(t,e){var n=e[0]>e[1]?e[0]:e[1],a=e[0]<e[1]?e[0]:e[1];return Math.max(Math.min(t,n),a)}var a=function(t){void 0===t&&(t=[]),this.elementsData=t,this._init()};return a.prototype.addElement=function(t){var e=this;this.elementsData.push(t),this._initElements(),setTimeout(function(){return e.update()},500)},a.prototype._init=function(){var t=this;this.scrolled=window.scrollY,this.viewport={height:window.innerHeight,width:window.innerWidth},this._initObserver(),this._initElements(),this._initEvents(),setTimeout(function(){return t.update()},500)},a.prototype._initElements=function(){var e=this;this.elements=[],this.elementsData.forEach(function(n){var a=t(n.element);n.element=a,n.omit||(n.rect=a.getBoundingClientRect(),e.addMissingTransformation(n),e.generateFixedData(n),a.style.opacity=n.opacity[0],a.style.transform="\n          translate3d(\n            "+n.translate.x[0]+n.translate.unit+",\n            "+n.translate.y[0]+n.translate.unit+",\n            0\n          )\n          rotate("+n.rotate[0]+"deg)\n          scale("+n.scale[0]+")"),e.observer.observe(a),e.elements.push(n.element)})},a.prototype._initObserver=function(){this.observer=new IntersectionObserver(function(t){t.forEach(function(t){t.intersectionRatio>0?t.target.classList.add("is-inViewPort"):t.target.classList.remove("is-inViewPort")})},{threshold:[0,.25,.75,1]})},a.prototype._initEvents=function(){var t=this;this.scrolling=!1,window.addEventListener("scroll",function(){t.scrolled=window.scrollY,t.scrolling||(window.requestAnimationFrame(function(){t.update(),t.scrolling=!1}),t.scrolling=!0)}),window.addEventListener("resize",e(function(){t.viewport={height:window.innerHeight,width:window.innerWidth},t.scrolled=window.scrollY,t.elements.forEach(function(e,n){t.generateFixedData(t.elementsData[n],e)}),console.log(t.elementsData),t.update()},100))},a.prototype.update=function(){var t=this;this.elements.forEach(function(e,n){var a=t.elementsData[n];if(e.classList.contains("is-inViewPort")||!a.class||"toggle"!==Object.values(a.class)[0]){if(e.classList.contains("is-inViewPort")){if(a.class){var i="string"==typeof a.class?a.class:Object.keys(a.class)[0];e.classList.add(i)}a.omit||(t.transform=t.getTransform(a),e.style.transform="\n          translate3d(\n            "+t.transform.x+a.translate.unit+",\n            "+t.transform.y+a.translate.unit+",\n            0\n          )\n          rotate("+t.transform.deg+"deg)\n          scale("+t.transform.scale+")",e.style.opacity=t.transform.opacity)}}else e.classList.remove(Object.keys(a.class)[0])})},a.prototype.getTransform=function(t){var e=this.scrolled-t.position,a=t.unitPerScroll;return{y:a.y?n(t.translate.y[0]+e*a.y,t.translate.y):0,x:a.x?n(t.translate.x[0]+e*t.unitPerScroll.x,t.translate.x):0,deg:a.deg?n(t.rotate[0]+e*t.unitPerScroll.deg,t.rotate):0,scale:a.scale?n(t.scale[0]+e*t.unitPerScroll.scale,t.scale):1,opacity:a.opacity?n(t.opacity[0]+e*t.unitPerScroll.opacity,t.opacity):1}},a.prototype.addMissingTransformation=function(t){t.translate||(t.translate={}),t.translate.x||(t.translate.x=[0,0]),t.translate.y||(t.translate.y=[0,0]),t.translate.unit||(t.translate.unit="px"),t.rotate||(t.rotate=[0,0]),t.opacity||(t.opacity=[1,1]),t.scale||(t.scale=[1,1])},a.prototype.generateFixedData=function(t){var e={y:Math.abs(t.translate.y[1]-t.translate.y[0]),x:Math.abs(t.translate.x[1]-t.translate.x[0]),deg:Math.abs(t.rotate[1]-t.rotate[0]),scale:Math.abs(t.scale[1]-t.scale[0]),opacity:Math.abs(t.opacity[1]-t.opacity[0])},n=0===e.y||0===t.translate.y[1]?1:Math.sign(t.translate.y[1]),a="px"===t.translate.unit?e.y:t.element.parentNode.clientHeight*e.y/100,i=this.viewport.height+a+n*t.rect.height;t.position=this.scrolled+t.rect.top-this.viewport.height,t.unitPerScroll={y:Math.sign(t.translate.y[1])*e.y/i,x:Math.sign(t.translate.x[1])*e.x/i,deg:Math.sign(t.rotate[1])*e.deg/i,scale:(t.scale[0]>t.scale[1]?-1:1)*e.scale/i,opacity:(t.opacity[0]>t.opacity[1]?-1:1)*e.opacity/i}},a});