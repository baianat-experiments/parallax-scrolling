var t,e;t=this,e=function(){"use strict";var a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),o=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function r(t,e){var n=o(e,2),i=n[0],a=n[1],r=a<i?i:a,s=i<a?i:a;return Math.max(Math.min(t,r),s)}function s(t,e,n){return"px"===e?t:t/100*n}function l(t,e){var n=o(t,2),i=n[0];return(n[1]-i)/e}return function(){function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).breakpoint,n=void 0===e?0:e;a(this,i),this.elementsData=t,this.settings={breakpoint:n},this._init()}return t(i,[{key:"addElement",value:function(t){var e=this;this.elementsData.push(t),this._initElements(),setTimeout(function(){return e.update()},500)}},{key:"_init",value:function(){var t=this;this.scrolled=window.scrollY,this.viewport={height:window.innerHeight,width:window.innerWidth},document.onreadystatechange=function(){"complete"===document.readyState&&(t._initObserver(),t._initElements(),t._initEvents(),t.update(!0))}}},{key:"_initElements",value:function(){var i=this;this.mediaQuery=window.matchMedia("(min-width: "+this.settings.breakpoint+"px)"),this.elements=[],this.elementsData.forEach(function(t){var e,n="string"==typeof(e=t.element)?document.querySelector(e):e;t.element=n,t.omit||(t.rect=n.getBoundingClientRect(),i.addMissingTransformation(t),i.generateFixedData(t)),i.observer.observe(n),i.elements.push(t.element)})}},{key:"_initObserver",value:function(){this.observer=new IntersectionObserver(function(t){t.forEach(function(t){t.isIntersecting?t.target.dataset.fluxInViewport="true":t.target.dataset.fluxInViewport=""})})}},{key:"_initEvents",value:function(){var e=this;this.scrolling=!1,window.addEventListener("scroll",function(){e.scrolled=window.scrollY,e.scrolling||(window.requestAnimationFrame(function(){e.update(),e.scrolling=!1}),e.scrolling=!0)},{passive:!0}),window.addEventListener("resize",function(t){var e=arguments,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:16,i=!1;return function(){i||(t.apply(void 0,e),i=!0,setTimeout(function(){i=!1},n))}}(function(){e.viewport={height:window.innerHeight,width:window.innerWidth},e.scrolled=window.scrollY,e.elementsData.forEach(function(t){t.omit||(t.rect=t.element.getBoundingClientRect(),e.generateFixedData(t))}),e.update()},100))}},{key:"update",value:function(){var a=this,r=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.elements.forEach(function(t,e){var n=a.elementsData[e];if(t.dataset.fluxInViewport||!n.class||"toggle"!==Object.values(n.class)[0]){if(t.dataset.fluxInViewport||r){if(n.class){var i="string"==typeof n.class?n.class:Object.keys(n.class)[0];t.classList.add(i)}if(!a.mediaQuery.matches)return n.element.style.transform="",void(n.element.style.opacity="");n.omit||(a.transform=a.getTransform(n),t.style.transform="\n          translateX("+a.transform.x+n.translate.unit+")\n          translateY("+a.transform.y+n.translate.unit+")\n          rotate("+a.transform.deg+"deg)\n          scale("+a.transform.scale+")",t.style.opacity=a.transform.opacity)}}else t.classList.remove(Object.keys(n.class)[0])})}},{key:"getTransform",value:function(t){var e=this.scrolled-t.position,n=t.unitPerScroll;return{y:n.y?r(t.translate.y[0]+e*n.y,t.translate.y):0,x:n.x?r(t.translate.x[0]+e*n.x,t.translate.x):0,deg:n.deg?r(t.rotate[0]+e*n.deg,t.rotate):0,scale:n.scale?r(t.scale[0]+e*n.scale,t.scale):1,opacity:n.opacity?r(t.opacity[0]+e*n.opacity,t.opacity):1}}},{key:"addMissingTransformation",value:function(t){t.translate||(t.translate={}),t.translate.x||(t.translate.x=[0,0]),t.translate.y||(t.translate.y=[0,0]),t.translate.unit||(t.translate.unit="px")}},{key:"generateFixedData",value:function(t){var e=0,n=0;t.translate&&t.translate.y&&(e=s(t.translate.y[0],t.translate.unit,t.rect.height),n=s(t.translate.y[1]-t.translate.y[0],t.translate.unit,t.rect.height));var i=this.viewport.height+n+t.rect.height;t.position=this.scrolled+t.rect.top+e-this.viewport.height,t.unitPerScroll={y:t.translate.y?l(t.translate.y,i):void 0,x:t.translate.x?l(t.translate.x,i):void 0,deg:t.rotate?l(t.rotate,i):void 0,scale:t.scale?l(t.scale,i):void 0,opacity:t.opacity?l(t.opacity,i):void 0}}}]),i}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.flux=e();